name: Build Project
on:
    release:
        types: [created]
jobs:
    create_and_upload_release_asset:
        name: Create and Upload Release Asset for ${{ matrix.OS_NAME }}
        runs-on: ${{ matrix.OS_VERSION }}
        strategy:
            matrix:
                include:
                    - OS_VERSION: macos-latest
                      OS_NAME: MacOS
                      ASSET_NAME: Maze_Prodigy.zip
                      RUN_CMD: pyinstaller maze_prodigy/__main__.py --name "Maze_Prodigy" --onefile --windowed &&
                        cd dist/ &&
                        zip -r9 Maze_Prodigy Maze_Prodigy.app/                
                    - OS_VERSION: windows-latest
                      OS_NAME: Windows
                      ASSET_NAME: Maze_Prodigy.exe
                      RUN_CMD: pyinstaller maze_prodigy/__main__.py --name "Maze_Prodigy" --onefile --windowed 
        steps:
            - name: Checkout Code
              uses: actions/checkout@v3
            - name: Setup Python 3.11
              uses: actions/setup-python@v4
              with:
                python-version: '3.11'
            - name: Install Dependencies
              run: |
                python -m pip install --upgrade pip
                pip install -r requirements.txt
                pip install pyinstaller
            - name: Create Release Asset with Pyinstaller
              run: ${{ matrix.RUN_CMD }}
            - name: Upload Release Asset
              id: upload-release-asset
              uses: shogo82148/actions-upload-release-asset@v1
              env:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              with:
                upload_url: ${{ github.event.release.upload_url }}
                asset_path: ./dist/${{ matrix.ASSET_NAME }}
                asset_name: ${{ matrix.ASSET_NAME }}
